/*! mctad 2014-06-18 */
mctad={version:"0.0.1"},mctad.π=Math.PI,mctad.ε=1e-4,mctad.isInteger=function(a){return/^-?\d+$/.test(a)},mctad.allPositive=function(a){for(var b=!0,c=0;c<a.length;c++)if(a[c]<0){b=!1;break}return b},mctad.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},mctad.sortNumeric=function(a){return a.sort(function(a,b){return a-b}),a},mctad.toRadians=function(a){return"string"==typeof a||a instanceof String?"°"===a.trim().slice(-1)?Math.PI/180*parseFloat(a):parseFloat(a):a},mctad.getBaseLog=function(a,b){return Math.log(b)/Math.log(a)},mctad.getRandomArbitrary=function(a,b){return Math.random()*(b-a)+a},mctad.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},mctad.factorial=function(a){if(0>a)return null;for(var b=1,c=2;a>=c;c++)b*=c;return b},mctad.combination=function(a,b){return 0>a||0>b?void 0:b>a?0:this.factorial(a)/(this.factorial(b)*this.factorial(a-b))},mctad.arithmeticMean=function(a){return Array.isArray(a)&&0!==a.length?this.sum(a)/a.length:void 0},mctad.circularStandardDeviation=function(a){return Array.isArray(a)&&0!==a.length?Math.sqrt(-2*mctad.getBaseLog(10,1-mctad.meanResultantLength(a))):void 0},mctad.circularVariance=function(a){return Array.isArray(a)&&0!==a.length?1-mctad.meanResultantLength(a):void 0},mctad.meanDirection=function(a){if(!Array.isArray(a)||0===a.length)return void 0;for(var b,c,d,e={cos:0,sin:0},f=0;f<a.length;f++)e.cos+=Math.cos(mctad.toRadians(a[f])),e.sin+=Math.sin(mctad.toRadians(a[f]));return b=e.cos/a.length,c=e.sin/a.length,d=b>=0?Math.atan(c/b):Math.atan(c/b)+mctad.π},mctad.meanResultantLength=function(a){if(!Array.isArray(a)||0===a.length)return void 0;for(var b,c,d,e={cos:0,sin:0},f=0;f<a.length;f++)e.cos+=Math.cos(mctad.toRadians(a[f])),e.sin+=Math.sin(mctad.toRadians(a[f]));return b=e.cos/a.length,c=e.sin/a.length,d=Math.sqrt(Math.pow(b,2)+Math.pow(c,2))},mctad.medianDirection=function(){},mctad.geometricMean=function(a){return Array.isArray(a)&&0!==a.length&&this.allPositive(a)?Math.pow(this.product(a),1/a.length):void 0},mctad.mean=function(a){return this.arithmeticMean(a)},mctad.median=function(a){return Array.isArray(a)&&0!==a.length?(this.sortNumeric(a),a.length%2===0?(a[a.length/2-1]+a[a.length/2])/2:a[(a.length+1)/2-1]):null},mctad.mode=function(a){if(!Array.isArray(a)||0===a.length)return null;for(var b=[],c={},d=0,e=0;e<a.length;e++)c.hasOwnProperty(a[e])?c[a[e]]++:c[a[e]]=1,c[a[e]]>d&&(d=c[a[e]]);for(var f in c)c.hasOwnProperty(f)&&c[f]===d&&b.push(parseInt(f));return this.sortNumeric(b),b},mctad.product=function(a){if(!Array.isArray(a)||0===a.length)return void 0;for(var b=1,c=0;c<a.length;c++)b*=a[c];return b},mctad.sampleStandardDeviation=function(a){return Array.isArray(a)&&0!==a.length?Math.sqrt(this.sampleVariance(a)):null},mctad.sampleVariance=function(a){if(!Array.isArray(a)||0===a.length)return void 0;for(var b,c=0,d=0,e=0,f=0,g=0;g<a.length;g++)e++,b=a[g]-c,c+=b/e,f+=b*(a[g]-c);return d=f/(e-1)},mctad.simpleLinearRegression=function(a){if(!Array.isArray(a)||0===a.length)return void 0;for(var b,c,d,e=[],f=[],g=0,h=0,i=0,j=0;j<a.length;j++)e.push(a[j][0]),f.push(a[j][1]);for(x_bar=mctad.arithmeticMean(e),y_bar=mctad.arithmeticMean(f),j=0;j<a.length;j++)g+=(e[j]-x_bar)*(f[j]-y_bar),h+=Math.pow(e[j]-x_bar,2),i+=Math.pow(f[j]-y_bar,2);return b=g/Math.sqrt(h*i),d=b*(mctad.sampleStandardDeviation(f)/mctad.sampleStandardDeviation(e)),c=y_bar-d*x_bar,{x_bar:x_bar,y_bar:y_bar,rxy:b,R2:Math.pow(b,2),"α":c,"β":d}},mctad.sum=function(a){if(!Array.isArray(a)||0===a.length)return void 0;for(var b=0,c=0;c<a.length;c++)b+=a[c];return b},mctad.discreteMixins={p:function(a){return this.hasOwnProperty(a)?this[a].pmf:0},F:function(a){return this.hasOwnProperty(a)?this[a].cdf:a<this.domain.min?0:a>this.domain.max?1:void 0}},mctad.bernoulli=function(a){if(0>a||a>1)return void 0;var b={mean:a,median:function(){return.5>a?0:.5===a?.5:1}(),mode:function(){return.5>a?[0]:.5===a?[0,1]:[1]}(),variance:a*(1-a),skewness:(1-a-a)/Math.sqrt(a*(1-a)),entropy:-(1-a)*Math.log(1-a)-a*Math.log(a),domain:{min:0,max:1},range:{min:0,max:0},generate:function(){return mctad.getRandomArbitrary(0,1)<=a?1:0}};return b[0]={pmf:1-a,cdf:1-a},b[1]={pmf:a,cdf:1},b.range.max=a>1-a?.1*Math.ceil(10*a):.1*Math.ceil(10*(1-a)),mctad.extend(b,mctad.discreteMixins),b},mctad.binomial=function(a,b){if(0>b||b>1||!mctad.isInteger(a)||0>=a)return void 0;var c,d=0,e=0,f={mean:a*b,median:void 0,mode:function(){return(a+1)*b!==0&&mctad.isInteger((a+1)*b)?mctad.isInteger((a+1)*b)&&(a+1)*b>=1&&a>=(a+1)*b?[(a+1)*b-1,(a+1)*b]:a:[Math.floor((a+1)*b)]}(),variance:a*b*(1-b),skewness:(1-2*b)/Math.sqrt(a*b*(1-b)),entropy:void 0,domain:{min:0,max:1/0},range:{min:0,max:0},generate:function(){for(var c=[],d=0;a>d;d++)c.push(mctad.bernoulli(b).generate());return c}};do c=mctad.factorial(a)/(mctad.factorial(d)*mctad.factorial(a-d))*Math.pow(b,d)*Math.pow(1-b,a-d),e+=c,f[d]={pmf:c,cdf:e},c>f.range.max&&(f.range.max=.1*Math.ceil(10*c)),d++;while(f[d-1].cdf<1-mctad.ε);return f.domain.max=d-1,mctad.extend(f,mctad.discreteMixins),f},mctad.geometric=function(a){if(0>=a||a>1)return void 0;var b,c=0,d=0,e={mean:(1-a)/a,median:void 0,mode:0,variance:(1-a)/Math.pow(a,2),skewness:(2-a)/Math.sqrt(1-a),entropy:(-(1-a)*(Math.log(1-a)/Math.LN2)-a*(Math.log(a)/Math.LN2))/a,domain:{min:0,max:1/0},range:{min:0,max:0},generate:function(b){for(var c=[],d=0;b>d;d++)c.push(Math.floor(Math.log(mctad.getRandomArbitrary(0,1))/Math.log(1-a)));return c}};do b=a*Math.pow(1-a,c),d+=b,e[c]={pmf:b,cdf:d},b>e.range.max&&(e.range.max=.1*Math.ceil(10*b)),c++;while(e[c-1].cdf<1-mctad.ε);return e.domain.max=c-1,mctad.extend(e,mctad.discreteMixins),e},mctad.hypergeometric=function(a,b,c){if(!mctad.isInteger(a)||!mctad.isInteger(b)||!mctad.isInteger(c)||0>a||b>a||c>a)return void 0;var d,e=0,f=0,g={mean:c*b/a,median:void 0,mode:Math.floor((c+1)*(b+1)/(a+2)),variance:c*(b/a)*((a-b)/a)*((a-c)/(a-1)),skewness:(a-2*b)*Math.sqrt(a-1)*(a-2*c)/(Math.sqrt(c*b*(a-b)*(a-c))*(a-2)),entropy:void 0,domain:{min:0,max:1/0},range:{min:0,max:0}};do d=this.combination(b,e)*this.combination(a-b,c-e)/this.combination(a,c),f+=d,g[e]={pmf:d,cdf:f},d>g.range.max&&(g.range.max=.1*Math.ceil(10*d)),e++;while(g[e-1].cdf<1-mctad.ε);return g.domain.max=e-1,mctad.extend(g,mctad.discreteMixins),g},mctad.pascal={distribution:function(a,b){if(0>=b||b>=1||!mctad.isInteger(a)||0>=a)return void 0;var c,d=0,e=0,f={mean:a*b/(1-b),mode:function(){return a>1?Math.floor(b*(a-1)/(1-b)):0}(),variance:a*b/Math.pow(1-b,2),skewness:(1+b)/Math.sqrt(a*b),domain:{min:0,max:1/0},range:{min:0,max:0}};do c=mctad.combination(d+a-1,d)*Math.pow(1-b,a)*Math.pow(b,d),e+=c,f[d]={pmf:c,cdf:e},c>f.range.max&&(f.range.max=.1*Math.ceil(10*c)),d++;while(f[d-1].cdf<1-mctad.ε);return f.domain.max=d-1,mctad.extend(f,mctad.discreteMixins),f}},mctad.poisson=function(a){if(0>=a)return null;var b,c=0,d=0,e={mean:a,median:Math.floor(a+1/3-.02/a),mode:[Math.floor(a),Math.ceil(a)-1],variance:a,skewness:Math.pow(a,.5),domain:{min:0,max:1/0},range:{min:0,max:0}};do b=Math.pow(Math.E,-a)*Math.pow(a,c)/mctad.factorial(c),d+=b,e[c]={pmf:b,cdf:d},b>e.range.max&&(e.range.max=.1*Math.ceil(10*b)),c++;while(e[c-1].cdf<1-mctad.ε);return e.domain.max=c-1,mctad.extend(e,mctad.discreteMixins),e},mctad.discreteUniform=function(a,b){if(a>b||!mctad.isInteger(a)||!mctad.isInteger(b))return void 0;var c,d,e=0,f={mean:(a+b)/2,median:(a+b)/2,mode:void 0,variance:(Math.pow(b-a+1,2)-1)/12,skewness:0,entropy:Math.log(b-a+1),domain:{min:a,max:b},range:{min:0,max:0},generate:function(c){for(var d=[],e=0;c>e;e++)d.push(mctad.getRandomInt(a,b));return d}};for(c=a;b>=c;c++)d=1/(b-a+1),e+=d,f[c]={pmf:d,cdf:e},d>f.range.max&&(f.range.max=.1*Math.ceil(10*d));return mctad.extend(f,mctad.discreteMixins),f},mctad.continuousMixins={f:function(a){return this.pdf(a)},F:function(a){return this.cdf(a)}},mctad.erf=function(a){return 1-1/Math.pow(1+.0705230784*a+.0422820123*Math.pow(a,2)+.0092705272*Math.pow(a,3)+.0001520143*Math.pow(a,4)+.0002765672*Math.pow(a,5)+430638e-10*Math.pow(a,6),16)},mctad.chiSquared=function(a,b){if(0>a||0>=b||!mctad.isInteger(b))return void 0;var c={mean:b,median:b*Math.pow(1-2/(9*b),3),mode:Math.max(b-2,0),variance:2*b,skewness:Math.sqrt(8/b),entropy:void 0,domain:{min:0,max:1/0},generate:function(){return void 0},pdf:function(a){return λ*Math.pow(Math.E,-λ*a)},cdf:function(a){return 1-Math.pow(Math.E,-λ*a)}};return mctad.extend(c,mctad.continuousMixins),c},mctad.exponential=function(a){if(0>a)return void 0;var b={mean:1/a,median:1/a*Math.log(2),mode:0,variance:Math.pow(1/a,2),skewness:2,entropy:1-Math.log(a),domain:{min:0,max:1/0},generate:function(b){for(var c=[],d=0;b>d;d++)c.push(-(1/a)*Math.log(mctad.getRandomArbitrary(0,1)));return c},pdf:function(b){return a*Math.pow(Math.E,-a*b)},cdf:function(b){return 1-Math.pow(Math.E,-a*b)}};return mctad.extend(b,mctad.continuousMixins),b},mctad.lognormal=function(a,b){if(0>=a||0>=b)return void 0;var c={mean:Math.pow(Math.E,a+b/2),median:Math.pow(Math.E,a),mode:Math.pow(Math.E,a-b),variance:(Math.pow(Math.E,b)-1)*Math.pow(Math.E,2*a+b),skewness:(Math.pow(Math.E,b)+2)*Math.sqrt(Math.pow(Math.E,b)-1),entropy:.5*Math.log(2*mctad.π*b)+a,domain:{min:0,max:1/0},generate:function(c){var d=[];d=mctad.normal(a,b).generate(c);for(var e=0;c>e;e++)d[e]=Math.pow(Math.E,d[e]);return d},pdf:function(c){return 1/(c*Math.sqrt(2*mctad.π*b))*Math.pow(Math.E,-(Math.pow(Math.log(c)-a,2)/(2*b)))},cdf:function(c){var d=(Math.log(c)-a)/Math.sqrt(2*b);return d>=0?.5*(1+mctad.erf(d)):.5*(1-mctad.erf(d))}};return mctad.extend(c,mctad.continuousMixins),c},mctad.normal=function(a,b){if(0>=b)return void 0;var c={mean:a,median:a,mode:a,variance:b,skewness:0,entropy:.5*Math.log(2*mctad.π*Math.E*b),domain:{min:-1/0,max:1/0},generate:function(c){for(var d,e,f=[],g=[],h=[],i=0;c/2>i;i++){do f=[mctad.getRandomArbitrary(0,1),mctad.getRandomArbitrary(0,1)],g=[2*f[0]-1,2*f[1]-1],d=Math.pow(g[0],2)+Math.pow(g[1],2);while(d>1);e=Math.sqrt(-2*Math.log(d)/d),h.push(a+Math.sqrt(b)*g[0]*e,a+Math.sqrt(b)*g[1]*e)}return h.length===c+1&&h.pop(),h},pdf:function(c){return 1/(Math.sqrt(b)*Math.sqrt(2*mctad.π))*Math.pow(Math.E,-(Math.pow(c-a,2)/(2*b)))},cdf:function(c){var d=(c-a)/Math.sqrt(2*b);return d>=0?.5*(1+mctad.erf(d)):.5*(1-mctad.erf(-d))}};return mctad.extend(c,mctad.continuousMixins),c},mctad.triangular=function(a,b,c){if(a>=b||a>=c||c>=b)return void 0;var d={mean:(a+b+c)/3,median:function(){return c>(a+b)/2?a+Math.sqrt((b-a)*(c-a))/Math.sqrt(2):b-Math.sqrt((b-a)*(b-c))/Math.sqrt(2)}(),mode:c,variance:(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2)-a*b-a*c-b*c)/18,skewness:Math.sqrt(2)*(a+b-2*c)*(2*a-b-c)*(a-2*b+c)/(5*Math.pow(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2)-a*b-a*c-b*c,1.5)),entropy:.5+Math.log((b-a)/2),domain:{min:a,max:b},generate:function(d){for(var e=(c-a)/(b-a),f=[],g=0;d>g;g++){var h=mctad.getRandomArbitrary(0,1);f.push(e>=h?a+(b-a)*Math.sqrt(e*h):a+(b-a)*(1-Math.sqrt((1-e)*(1-h))))}return f},pdf:function(d){return d>=a&&c>=d?2*(d-a)/((b-a)*(c-a)):d>c&&b>=d?2*(b-d)/((b-a)*(b-c)):0},cdf:function(d){return a>d?0:d>=a&&c>=d?Math.pow(d-a,2)/((b-a)*(c-a)):d>c&&b>=d?1-Math.pow(b-d,2)/((b-a)*(b-c)):1}};return mctad.extend(d,mctad.continuousMixins),d},mctad.uniform=function(a,b){if(a>=b)return void 0;var c={mean:(a+b)/2,median:(a+b)/2,mode:void 0,variance:Math.pow(b-a,2)/12,skewness:0,entropy:Math.log(b-a),domain:{min:a,max:b},generate:function(c){for(var d=[],e=0;c>e;e++)d.push(a+(b-a)*mctad.getRandomArbitrary(0,1));return d},pdf:function(c){return c>=a&&b>=c?1/(b-a):0},cdf:function(c){return a>c?0:c>=a&&b>=c?(c-a)/(b-a):1}};return mctad.extend(c,mctad.continuousMixins),c};